---
title: "Notes for Predictive Modeling"
subtitle: "MSc in Big Data Analytics at Carlos III University of Madrid"
author: "Eduardo García Portugués"
date: "`r Sys.Date()`, v1.0"
knit: "bookdown::render_book"
documentclass: book
bibliography: PM-UC3M.bib
biblio-style: apalike
link-citations: yes
site: bookdown::bookdown_site
---

# Introduction {#intro}

<!--
(Move up once decided what options)
cover-image: no
description: "A subject within the MSc in Big Data Analytics at Carlos III University of Madrid (Spain)."
github-repo: egarpor/PM-UC3M
apple-touch-icon: "touch-icon.png"
apple-touch-icon-size: 120
favicon: "favicon.ico"
-->

```{block2, type = 'rmdcaution'}
The **animations** of these notes will not be displayed the first time they are browsed^[The reason is because they are hosted at `https` websites with auto-signed SSL certificates.]. See for example Figure \@ref(fig:leastsquares). **To see them**, click on the caption's link *"Application also available [here](https://ec2-35-177-34-200.eu-west-2.compute.amazonaws.com/least-squares/)"*. You will get a warning from your browser saying that *"Your connection is not private"*. Click in *"Advanced"* and **allow an exception** in your browser (I guarantee you I will not do anything evil!). The next time the animation will show up correctly within the notes.
```

## Course overview {#intro-course}

Welcome to the notes for *Predictive Modeling*. Along these notes we will see the theory and practice needed to implement the statistical methods presented in the lectures. The emphasis is placed in building intuition behind the methods, gaining insights into their properties, and showing their application through the use of statistical software. The topics we will cover are a in-depth analysis of **linear models** ([I](https://bookdown.org/egarpor/PM-UC3M/lm-i.html), [II](https://bookdown.org/egarpor/PM-UC3M/lm-ii.html), and [III](https://bookdown.org/egarpor/PM-UC3M/lm-iii.html)), their extension to
[**generalized linear models**](https://bookdown.org/egarpor/PM-UC3M/glm.html), and an introduction to [**nonparametric regression**](https://bookdown.org/egarpor/PM-UC3M/npreg.html).

The notes contain a substantial amount of snippets of code that are fully self-contained. The **software** employed in the course is *the* statistical language [`R`](https://cran.r-project.org/) and its most common IDE (Integrated Development Environment) nowadays, [`RStudio`](https://www.rstudio.com/products/rstudio/download/). A basic prior knowledge of both is assumed^[Among others: basic programming in `R`, ability to work with objects and data structures, ability to produce graphics, knowledge of the main statistical functions, ability to run scripts in `RStudio`.]. The appendix presents basic introductions to `RStudio` and `R` for those students lacking basic expertise on them.

The **Shiny interactive apps** on the notes can be downloaded and run locally. This allows in particular to examine their codes. Check [this GitHub repository](https://github.com/egarpor/ShinyServer) for the sources.

The required packages for the course are (list to be updated):
```{r, echo = TRUE, cache = TRUE, warning = FALSE, message = FALSE, eval = FALSE}
# Install packages
install.packages(c("car"))#, "caret", "rgl", "lars", "KernSmooth", "locfit"))
```

The codes in the notes may assume that the packages have been loaded, so it is better to do it now:
```{r, echo = TRUE, cache = TRUE, warning = FALSE, message = FALSE}
# Load packages
library(MASS)
library(car)
# library(caret)
# library(rgl)
# library(lars)
# library(KernSmooth)
# library(locfit)
```
<!--

## What is *predictive modeling*? {#intro-what-is}

The objective of predictive modeling is to make an accurate prediction.

> Predictive modeling is the process of developing a mathematical tool or model that generates an accurate prediction.

The process by which a model is created or chosen to try to best pedcit the probability of an outcome.

Prediction versus interpretability

black boxes.

statistical models with neat interpretations of the parameters.

- $Y$
- $X$, 

Bold letters

Capitals represent random variables, 
In the following, **bold face** are used for distinguishing vectors and matrices from scalars

$\sim$

The vectors are regarded as column matrices.

$\mathcal{N}_m$

With $m=1$, the density of a $\mathcal{N}_{m}$ corresponds to a bell-shaped *curve* With $m=2$, the density is a *surface* similar to a bell.

where $\mathcal{N}_{n}$ is the $n$-dimensional Normal.

correctness and usefulness

## The dangers of over-fitting {#intro-over-fitting}

App. Polynomial regression.

```{r, overfitting, echo = FALSE, fig.cap = 'Over-fitting illustration.', screenshot.alt = "images/screenshots/over-fitting.png", dev = 'png', cache = TRUE, fig.pos = 'h!', out.width = '90%'}
knitr::include_app('https://ec2-35-177-34-200.eu-west-2.compute.amazonaws.com/over-fitting/', height = '550px')
```

## Data splitting {#intro-data-splitting}

General strategy.

-->

## Datasets for the course {#intro-datasets}

This is a (constantly updated) handy list of all the relevant datasets used in the course. To download them, simply **save the link as a file** in your browser.

- `least-squares.RData` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/least-squares.RData)). Contains a single `data.frame`, named `leastSquares`, with 50 observations of the variables `x`, `yLin`, `yQua` and `yExp`. These are generated as $X\sim\mathcal{N}(0,1)$, $Y_\mathrm{lin}=-0.5+1.5X+\varepsilon$, $Y_\mathrm{qua}=-0.5+1.5X^2+\varepsilon$ and $Y_\mathrm{exp}=-0.5+1.5\cdot2^X+\varepsilon$, with $\varepsilon\sim\mathcal{N}(0,0.5^2)$. The purpose of the dataset is to illustrate the least squares fitting.

- `assumptions.RData` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/assumptions.RData)). Contains the data frame `assumptions` with 200 observations of the variables `x1`, ..., `x9` and `y1`, ..., `y9`. The purpose of the dataset is to identify which regression `y1 ~ x1`, ..., `y9 ~ x9` fulfills the assumptions of the linear model. The dataset `moreAssumptions.RData` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/moreAssumptions.RData)) has the same structure.

- `assumptions3D.RData` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/assumptions3D.RData)). Contains the data frame `assumptions3D` with 200 observations of the variables `x1.1`, ..., `x1.8`, `x2.1`, ..., `x2.8` and `y.1`, ..., `y.8`. The purpose of the dataset is to identify which regression `y.1 ~ x1.1 + x2.1`, ..., `y.8 ~ x1.8 + x2.8` fulfills the assumptions of the linear model.

- `wine.csv` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/wine.csv)). The dataset is formed by the auction `Price` of 27 red Bordeaux vintages, five vintage descriptors (`WinterRain`, `AGST`, `HarvestRain`, `Age`, `Year`) and the population of France in the year of the vintage, `FrancePop`.

- `Boston.xlsx` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/Boston.xlsx)). The dataset contains 14 variables describing 506 suburbs in Boston. Among those variables, `medv` is the median house value, `rm` is the average number of rooms per house and `crim` is the per capita crime rate. The full description is available in `?Boston`.

- `cpus.txt` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/cpus.txt)) and `gpus.txt` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/gpus.txt)). The datasets contain 102 and 35 rows, respectively, of commercial CPUs and GPUs appeared since the first models up to nowadays. The variables in the datasets are `Processor`, `Transistor count`, `Date of introduction`, `Manufacturer`, `Process` and `Area`.

<!-- - `la-liga-2015-2016.xlsx` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/la-liga-2015-2016.xlsx)). Contains 19 performance metrics for the 20 football teams in La Liga 2015/2016. -->

<!-- - `challenger.txt` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/challenger.txt)). Contains data for 23 Space-Shuttle launches. The data consists of 23 shuttle flights. There are 8 variables. Among them: `temp`, the temperature in Celsius degrees at the time of launch, and `fail.field`	and `fail.nozzle`, indicators of whether there were an incidents in the O-rings of the field joints and nozzles of the solid rocket boosters. -->

<!-- - `Chile.txt` ([download](https://raw.githubusercontent.com/egarpor/PM-UC3M/master/datasets/Chile.txt)). Contains data for 2700 respondents on a survey for the voting intentions in the 1988 Chilean national plebiscite. There are 8 variables: `region`, `population`, `sex`, `age`, `education`, `income`, `statusquo` (scale of support for the status quo) and `vote`. `vote` is a factor with levels `A` (abstention), `N` (against Pinochet), `U` (undecided), `Y` (for Pinochet). Available in `R` through the package `car` and `data(Chile)`. -->

## Main references and credits {#intro-credits}

Several great reference books have been used for preparing these notes. The following list details the sections in which each of them has been consulted (list to be updated):

- @Kuhn2013 <!-- (Sections \@ref(intro-data-splitting), \@ref(intro-what-is)) -->
- @James2013 <!-- (Sections \@ref(lm-i-model) -- \@ref(lm-i-modfit), \@ref(lm-i-lab-boston)) -->
- @Fan1996 <!-- (Sections \@ref(reg-kre), \@ref(reg-asymp), \@ref(reg-bwd)). -->
- @Pena2002 <!--(Sections \@ref(lm-i-model) -- \@ref(lm-i-modfit)) -->
- @Loader1999 <!-- (Section \@ref(reg-loclik)). -->
- @Wand1995 <!-- (Sections \@ref(reg-loclik)). -->
- @Wasserman2004 <!-- (Sections \@ref(reg-param), \@ref(reg-loclik)). -->
- @Wasserman2006 <!-- (Sections \@ref(reg-bwd)). -->

In addition, these notes are possible due to the existence of these incredible pieces of software: @R-bookdown, @R-knitr, @R-rmarkdown, and @R-base.

The icons used in the notes were designed by [madebyoliver](http://www.flaticon.com/authors/madebyoliver), [freepik](http://www.flaticon.com/authors/freepik), and [roundicons](http://www.flaticon.com/authors/roundicons) from [Flaticon](http://www.flaticon.com/).

All material in these notes is licensed under [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/).
